use plotters::prelude::*;

struct PaletteTurbo;

impl Palette for PaletteTurbo {
    // calculated from https://gist.github.com/mikhailov-work/ee72ba4191942acecc03fe6da94fc73f
    const COLORS: &'static [(u8, u8, u8)] = &[
        (48, 18, 59),
        (49, 21, 66),
        (51, 24, 74),
        (52, 27, 81),
        (53, 30, 88),
        (54, 33, 95),
        (55, 36, 102),
        (56, 38, 108),
        (57, 41, 115),
        (58, 44, 121),
        (59, 47, 128),
        (60, 50, 134),
        (61, 53, 139),
        (62, 56, 145),
        (62, 58, 151),
        (63, 61, 156),
        (64, 64, 162),
        (64, 67, 167),
        (65, 70, 172),
        (66, 72, 177),
        (66, 75, 182),
        (67, 78, 186),
        (67, 81, 191),
        (68, 83, 195),
        (68, 86, 199),
        (69, 89, 203),
        (69, 91, 207),
        (69, 94, 211),
        (69, 97, 215),
        (70, 99, 218),
        (70, 102, 221),
        (70, 105, 225),
        (70, 107, 228),
        (70, 110, 231),
        (70, 113, 233),
        (70, 115, 236),
        (70, 118, 238),
        (70, 120, 241),
        (70, 123, 243),
        (70, 125, 245),
        (70, 128, 247),
        (70, 130, 249),
        (70, 133, 250),
        (69, 135, 252),
        (69, 138, 253),
        (68, 140, 254),
        (68, 143, 254),
        (67, 145, 255),
        (66, 148, 255),
        (65, 150, 255),
        (63, 153, 255),
        (62, 155, 255),
        (61, 158, 254),
        (59, 161, 253),
        (58, 163, 253),
        (56, 166, 251),
        (54, 168, 250),
        (53, 171, 249),
        (51, 173, 247),
        (49, 176, 246),
        (47, 178, 244),
        (45, 181, 242),
        (44, 183, 240),
        (42, 185, 238),
        (40, 188, 236),
        (38, 190, 234),
        (37, 192, 231),
        (35, 195, 229),
        (33, 197, 226),
        (32, 199, 224),
        (31, 201, 221),
        (29, 204, 219),
        (28, 206, 216),
        (27, 208, 213),
        (26, 210, 211),
        (25, 212, 208),
        (24, 214, 205),
        (24, 216, 203),
        (24, 218, 200),
        (23, 219, 197),
        (23, 221, 195),
        (23, 223, 192),
        (24, 224, 190),
        (24, 226, 187),
        (25, 227, 185),
        (26, 229, 183),
        (27, 230, 180),
        (29, 232, 178),
        (30, 233, 175),
        (32, 234, 173),
        (34, 236, 170),
        (36, 237, 167),
        (39, 238, 164),
        (41, 239, 161),
        (44, 240, 158),
        (47, 241, 155),
        (50, 242, 152),
        (53, 243, 148),
        (56, 244, 145),
        (60, 245, 142),
        (63, 246, 139),
        (67, 247, 135),
        (70, 248, 132),
        (74, 249, 128),
        (78, 250, 125),
        (81, 250, 121),
        (85, 251, 118),
        (89, 252, 115),
        (93, 252, 111),
        (97, 253, 108),
        (101, 253, 105),
        (105, 254, 101),
        (109, 254, 98),
        (113, 254, 95),
        (117, 255, 92),
        (121, 255, 89),
        (125, 255, 86),
        (128, 255, 83),
        (132, 255, 80),
        (136, 255, 78),
        (139, 255, 75),
        (143, 255, 73),
        (146, 255, 70),
        (150, 255, 68),
        (153, 255, 66),
        (156, 254, 64),
        (159, 254, 62),
        (162, 253, 61),
        (164, 253, 59),
        (167, 252, 58),
        (170, 252, 57),
        (172, 251, 56),
        (175, 250, 55),
        (177, 249, 54),
        (180, 248, 53),
        (183, 248, 53),
        (185, 246, 52),
        (188, 245, 52),
        (191, 244, 52),
        (193, 243, 52),
        (196, 242, 51),
        (198, 240, 51),
        (201, 239, 52),
        (203, 238, 52),
        (206, 236, 52),
        (208, 235, 52),
        (210, 233, 52),
        (213, 232, 53),
        (215, 230, 53),
        (217, 228, 53),
        (219, 226, 54),
        (221, 225, 54),
        (224, 223, 55),
        (226, 221, 55),
        (228, 219, 56),
        (230, 217, 56),
        (231, 215, 56),
        (233, 213, 57),
        (235, 211, 57),
        (237, 209, 57),
        (238, 207, 58),
        (240, 205, 58),
        (241, 203, 58),
        (243, 201, 58),
        (244, 199, 58),
        (245, 197, 58),
        (247, 195, 58),
        (248, 193, 58),
        (249, 191, 57),
        (250, 189, 57),
        (250, 186, 56),
        (251, 184, 56),
        (252, 182, 55),
        (252, 180, 54),
        (253, 177, 53),
        (253, 175, 53),
        (254, 172, 52),
        (254, 169, 51),
        (254, 167, 50),
        (254, 164, 49),
        (255, 161, 47),
        (255, 158, 46),
        (255, 156, 45),
        (255, 153, 44),
        (254, 150, 43),
        (254, 147, 42),
        (254, 144, 40),
        (254, 141, 39),
        (253, 138, 38),
        (253, 135, 36),
        (252, 132, 35),
        (252, 129, 34),
        (251, 126, 32),
        (251, 123, 31),
        (250, 120, 30),
        (249, 117, 28),
        (248, 114, 27),
        (248, 111, 26),
        (247, 108, 25),
        (246, 105, 23),
        (245, 102, 22),
        (244, 99, 21),
        (243, 96, 20),
        (242, 93, 19),
        (240, 91, 17),
        (239, 88, 16),
        (238, 85, 15),
        (237, 83, 14),
        (235, 80, 14),
        (234, 78, 13),
        (233, 75, 12),
        (231, 73, 11),
        (230, 71, 10),
        (228, 69, 10),
        (227, 66, 9),
        (225, 64, 9),
        (223, 62, 8),
        (222, 60, 7),
        (220, 58, 7),
        (218, 56, 6),
        (216, 54, 6),
        (214, 52, 5),
        (212, 50, 5),
        (210, 49, 5),
        (208, 47, 4),
        (206, 45, 4),
        (204, 43, 3),
        (202, 41, 3),
        (200, 40, 3),
        (198, 38, 2),
        (195, 36, 2),
        (193, 35, 2),
        (191, 33, 2),
        (188, 31, 1),
        (186, 30, 1),
        (183, 28, 1),
        (180, 27, 1),
        (178, 25, 1),
        (175, 24, 1),
        (172, 22, 1),
        (170, 21, 1),
        (167, 20, 1),
        (164, 18, 1),
        (161, 17, 1),
        (158, 16, 1),
        (155, 15, 1),
        (152, 13, 1),
        (149, 12, 1),
        (146, 11, 1),
        (142, 10, 1),
        (139, 9, 1),
        (136, 8, 1),
        (133, 7, 1),
        (129, 6, 2),
        (126, 5, 2),
        (122, 4, 2),
    ];
}

fn main() -> Result<(), Box<dyn std::error::Error>> {
    const WIDTH: f64 = 600.0;
    const HEIGHT: u32 = 100;

    let root_drawing_area =
        BitMapBackend::new("turbo-heatmap.png", (WIDTH as u32, HEIGHT)).into_drawing_area();
    let child_drawing_areas = root_drawing_area.split_evenly((1, WIDTH as usize));

    let pal_len = PaletteTurbo::COLORS.len() as f64;
    for (area, idx) in child_drawing_areas
        .into_iter()
        .zip((0..WIDTH as usize).map(|x| x as f64))
    {
        area.fill(&PaletteTurbo::pick(((idx / WIDTH) * pal_len) as usize))?;
    }
    root_drawing_area.present()?;
    Ok(())
}
